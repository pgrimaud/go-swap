{% extends 'base.html.twig' %}

{% block title %}Pok√©dex - Go Swap{% endblock %}

{% block body %}
    <div class="min-h-screen bg-gray-50 dark:bg-gray-900" 
         data-controller="pokedex"
         data-pokedex-url-value="{{ path('api_pokedex') }}"
         data-pokedex-variant-value="{{ currentVariant }}"
         data-pokedex-search-value="{{ currentSearch }}"
         data-turbo="false">
        {% include 'partials/header.html.twig' %}

        {# Filters Section #}
        <div class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-16 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="space-y-4">
                    {# Search Bar #}
                    <div class="flex flex-col sm:flex-row gap-3">
                        <div class="flex-1">
                            <input 
                                type="text" 
                                data-pokedex-target="searchInput"
                                data-action="input->pokedex#search"
                                value="{{ currentSearch }}"
                                placeholder="üîç Search by name or number..."
                                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"
                            >
                        </div>
                    </div>

                    {# Variant Filters - Responsive: icons on mobile, text+icons on desktop #}
                    <div class="overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0">
                        <div class="flex gap-2 items-center sm:flex-wrap">
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant=""
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg text-sm font-medium inline-flex items-center justify-center cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="All variants">
                                All
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="normal"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Normal">
                                <img src="{{ asset('images/pokedex/normal.png') }}" alt="Normal" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Normal</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="shiny"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Shiny">
                                <img src="{{ asset('images/pokedex/shiny.png') }}" alt="Shiny" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Shiny</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="shadow"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Shadow">
                                <img src="{{ asset('images/pokedex/shadow.png') }}" alt="Shadow" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Shadow</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="purified"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Purified">
                                <img src="{{ asset('images/pokedex/purified.png') }}" alt="Purified" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Purified</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="lucky"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Lucky">
                                <img src="{{ asset('images/pokedex/lucky.png') }}" alt="Lucky" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Lucky</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="xxl"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="XXL">
                                <img src="{{ asset('images/pokedex/xxl.png') }}" alt="XXL" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">XXL</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="xxs"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="XXS">
                                <img src="{{ asset('images/pokedex/xxs.png') }}" alt="XXS" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">XXS</span>
                            </button>
                            <button type="button" 
                                    data-action="click->pokedex#filter"
                                    data-variant="perfect"
                                    class="flex-shrink-0 p-2 sm:px-4 sm:py-2 rounded-lg inline-flex items-center gap-1.5 text-sm font-medium cursor-pointer bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 opacity-60"
                                    title="Perfect">
                                <img src="{{ asset('images/pokedex/perfect.png') }}" alt="Perfect" class="w-6 h-6 sm:w-4 sm:h-4">
                                <span class="hidden sm:inline">Perfect</span>
                            </button>
                        </div>
                    </div>
                </div>

                {# Stats Bar - Only show when All filter is active #}
                {% if currentVariant == '' %}
                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400">
                            <span class="font-medium">
                                Showing: <span class="text-blue-600 dark:text-blue-400">{{ allPokemon|length }}</span> Pok√©mon
                            </span>
                            <span class="text-gray-400">|</span>
                            <span>
                                Owned: <span class="text-green-600 dark:text-green-400 font-medium">0</span> / {{ allPokemon|length }}
                            </span>
                            <span class="text-gray-400">|</span>
                            <span>
                                Complete (8/8): <span class="text-purple-600 dark:text-purple-400 font-medium">0</span>
                            </span>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        {# Pok√©mon Grid #}
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            {# Grid container - empty, filled by Stimulus controller #}
            <div data-pokedex-target="grid" 
                 class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                {# Cards will be injected here by JavaScript #}
            </div>

            {# Infinite scroll loader #}
            <div data-pokedex-target="loader" class="mt-8 text-center py-8">
                <div class="hidden inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600" data-pokedex-target="spinner"></div>
                <p class="hidden mt-4 text-gray-600 dark:text-gray-400" data-pokedex-target="loaderText">Loading more Pok√©mon...</p>
            </div>
        </main>
    </div>
{% endblock %}
